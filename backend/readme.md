-- Database Schema Setup

create table public.students (
  id bigint generated by default as identity not null,
  student_id text null,
  name text null,
  father_name text null,
  email text null,
  phone text null,
  phone2 text null,
  emergency_contact text null,
  dob date null,
  address text null,
  profile_pic_url text null,
  gender text null,
  course text null,
  session text null,
  constraint students_pkey primary key (id),
  constraint students_student_id_key unique (student_id)
) TABLESPACE pg_default;



# Storage Bucket Setup

-- Create the storage bucket for student photos
INSERT INTO storage.buckets (id, name, public)
VALUES ('student-photos', 'student-photos', true)
ON CONFLICT (id) DO NOTHING;

-- Set up storage policies for the bucket

-- Policy for allowing public file uploads
CREATE POLICY "Allow public uploads" ON storage.objects
FOR INSERT TO public WITH CHECK (bucket_id = 'student-photos');

-- Policy for allowing public file updates
CREATE POLICY "Allow public updates" ON storage.objects
FOR UPDATE TO public USING (bucket_id = 'student-photos');

-- Policy for allowing public file access
CREATE POLICY "Allow public access" ON storage.objects
FOR SELECT TO public USING (bucket_id = 'student-photos');

-- Policy for allowing public file deletion (optional - enable if needed)
-- CREATE POLICY "Allow public deletion" ON storage.objects
-- FOR DELETE TO public USING (bucket_id = 'student-photos');






# Fees 

create table public.fees_paid (
  id bigint generated by default as identity not null,
  name text null,
  date date null,
  amount text null,
  student_id text null,
  constraint fees_paid_pkey primary key (id)
) TABLESPACE pg_default;

create table public.fees_overdue (
  id bigint generated by default as identity not null,
  name text null,
  amount text null,
  student_id text null,
  constraint fees_overdue_pkey primary key (id)
) TABLESPACE pg_default;

create table public.fees_unpaid (
  id bigint generated by default as identity not null,
  name text null,
  amount text null,
  student_id text null,
  constraint fees_unpaid_pkey primary key (id)
) TABLESPACE pg_default;

